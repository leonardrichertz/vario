<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF Pro Text:wght@600&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Segoe UI:wght@400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../styles/styles.css"/>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>

    <!-- Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.7.0/dist/umd/popper.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <title>Studienprojekt</title>
</head>
<body>

<script type="module">
    import { map } from '../scripts/map.js';
    $(document).ready(function () {
        console.log("Document ready, initializing map.");
        map();
    });
</script>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-custom">
    <div class="container-fluid">
        <a class="navbar-brand" href="#" id="sidebarToggle">
            <img src="../assets/img/Menu.svg" alt="Menu" width="30" height="24">
        </a>
        <span class="color-text">Variometer</span>
        <div class="start-button-section">
            <button class="start-button color-text" id="requestOrientationPermissionButton">Start</button>
        </div>
    </div>
</nav>

<!-- Compass Section -->
<div class="container-fluid compass-section">
    <div class="row justify-content-center align-items-center">
        <div class="col-auto d-flex align-items-center">
            <img src="../assets/img/height.svg" alt="Another Image" class="mr-2 img-height">
            <span class="badge badge-secondary badge-lg">0.0</span>
        </div>
        <div class="col-auto">
            <img src="../assets/img/compass.svg" alt="Compass" class="img-compass">
        </div>
    </div>
</div>

<div id="map"></div>

<!-- Speed Labels -->
<div class="container-fluid speed-section d-flex justify-content-around align-items-center">
    <div class="circle-label-container">
        <span class="circle-label circle-lg"></span>
        <div class="label-text color-text">Geschwindigkeit von Aufstieg</div>
    </div>
    <div class="circle-label-container">
        <span class="circle-label circle-lg"></span>
        <div class="label-text color-text">Geschwindigkeit von Abstieg</div>
    </div>
    <div class="circle-label-container">
        <span class="circle-label circle-lg"></span>
        <div class="label-text color-text">Geschwindigkeit über Boden</div>
    </div>
</div>

<!-- Statistics Labels -->
<div class="container-fluid statistic-section">
    <div class="row justify-content-around align-items-center">
        <!-- First Container Pair -->
        <div class="col-sm-6 col-md-4 mb-3 d-flex justify-content-center">
            <div class="container-pair d-flex align-items-center">
                <span class="circle-label circle-lg">
                    <img src="../assets/img/Vector.svg" alt="Image 1" class="img-small">
                </span>
                <div class="label-text color-text ml-2">Zeit in min</div>
            </div>
        </div>

        <!-- Second Container Pair -->
        <div class="col-sm-6 col-md-4 mb-3 d-flex justify-content-center">
            <div class="container-pair d-flex align-items-center">
                <span class="circle-label circle-lg">
                    <img src="../assets/img/Map.svg" alt="Image 2" class="img-small">
                </span>
                <div class="label-text color-text ml-2">Strecke in m</div>
            </div>
        </div>
    </div>
</div>


<!-- Sidebar -->
<div class="sidebar " id="sidebar">
    <ul class="list-unstyled">
        <li class="sidebar-item" onclick="closeSidebar()">
            <a href="#" class="sidebar-link">
                Zurück zur Übersicht
            </a>
        </li>
        <li class="sidebar-item">
            <a href="#" class="sidebar-link">
                Gespeicherte Flüge
            </a>
        </li>
        <li class="sidebar-item">
            <a href="#" class="sidebar-link">
                Einstellungen
            </a>
        </li>
    </ul>
</div>


<!-- Save Button -->
<div class="container-fluid button-section">
    <div class="row justify-content-center">
        <div class="col-md-auto text-center">
            <button type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#exampleModal">
                Strecke abspeichern
            </button>
        </div>
    </div>
</div>






<!-- Javascript Map -->
<script>
    var map = L.map('map').setView([51.505, -0.09], 13); // Set the initial center and zoom level

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
</script>

<!-- Javascript Close Sidebar -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script>
    function closeSidebar() {
        $('#sidebar').removeClass('show'); // Close the sidebar
    }

    $(document).ready(function() {
        $('#sidebarToggle').click(function(e) {
            e.stopPropagation(); // Prevent the click event from bubbling up to the document
            $('#sidebar').toggleClass('show'); // Toggle the 'show' class on the sidebar
        });

        $(document).click(function(e) {
            if (!$(e.target).closest('.sidebar').length && !$(e.target).closest('#sidebarToggle').length) {
                $('#sidebar').removeClass('show'); // Close the sidebar if the click is outside the sidebar and sidebar toggle button
            }
        });
    });


    $(document).ready(function() {
        $('#sidebarToggle').click(function(e) {
            e.stopPropagation(); // Prevent the click event from bubbling up to the document
            $('#sidebar').toggleClass('show'); // Toggle the 'show' class on the sidebar
        });

        $(document).click(function(e) {
            if (!$(e.target).closest('#sidebar').length) {
                $('#sidebar').removeClass('show'); // Close the sidebar
            }
        });

        $('#requestOrientationPermissionButton').click(function() {
            console.log("Button clicked, requesting orientation permission.");
            if (DeviceOrientationEvent && typeof DeviceOrientationEvent.requestPermission === "function") {
                DeviceOrientationEvent.requestPermission().then(permissionState => {
                    if (permissionState === 'granted') {
                        window.addEventListener('deviceorientation', handleOrientation);
                    }
                }).catch(console.error);
            } else {
                window.addEventListener('deviceorientation', handleOrientation);
            }
        });
    });

    function handleOrientation(event) {
        var alpha = event.alpha;
        var beta = event.beta;
        var gamma = event.gamma;
        console.log(`Alpha: ${alpha}, Beta: ${beta}, Gamma: ${gamma}`);
    }
</script>